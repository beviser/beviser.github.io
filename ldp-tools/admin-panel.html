<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDP TOOLS - Admin Panel</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="light-beam"></div>
        <div class="light-beam"></div>
        <div class="light-beam"></div>
    </div>

    <!-- Header -->
    <header class="main-header">
        <div class="menu-icon" id="menuIcon">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <a href="home.html" class="logo">LDP TOOLS</a>
        <div class="user-info">
            <span class="username" id="headerUsername">Admin</span>
            <div class="balance-box" id="headerBalance">100,000,000ƒë</div>
        </div>
    </header>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <ul>
            <li onclick="window.location.href='home.html'">
                <i>üè†</i> Trang ch·ªß
            </li>
            <li onclick="window.location.href='#account'">
                <i>üë§</i> Ki·ªÉm tra t√†i kho·∫£n
            </li>
            <li onclick="window.location.href='deposit.html'">
                <i>üí∞</i> N·∫°p ti·ªÅn
            </li>
            <li onclick="showHistory()">
                <i>üìú</i> L·ªãch s·ª≠ mua
            </li>
            <li onclick="window.location.href='admin-panel.html'">
                <i>‚öôÔ∏è</i> Control Panel
            </li>
            <li onclick="logout()">
                <i>üö™</i> ƒêƒÉng xu·∫•t
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="admin-container">
            <div class="admin-header">
                <h1 class="admin-title">CONTROL PANEL</h1>
                <p class="admin-subtitle">Qu·∫£n l√Ω h·ªá th·ªëng LDP Tools</p>
            </div>

            <!-- Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">T·ªïng ng∆∞·ªùi d√πng</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalRevenue">0ƒë</div>
                    <div class="stat-label">T·ªïng doanh thu</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeTools">0</div>
                    <div class="stat-label">Tool ƒëang ho·∫°t ƒë·ªông</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalVouchers">0</div>
                    <div class="stat-label">M√£ gi·∫£m gi√°</div>
                </div>
            </div>

            <!-- Admin Panels Grid -->
            <div class="admin-grid">
                <!-- User Management Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üë•</div>
                        <h3 class="panel-title">Danh S√°ch User</h3>
                    </div>
                    <div class="user-list" id="userList">
                        <!-- Users will be loaded here -->
                        <div class="empty-state">
                            <div class="empty-icon">üë§</div>
                            <div class="empty-title">Ch∆∞a c√≥ ng∆∞·ªùi d√πng</div>
                        </div>
                    </div>
                </div>

                <!-- Transfer Money Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üí∏</div>
                        <h3 class="panel-title">Chuy·ªÉn Ti·ªÅn Cho User</h3>
                    </div>
                    <form class="admin-form" id="transferForm">
                        <div class="form-group">
                            <label>T√™n t√†i kho·∫£n ng∆∞·ªùi nh·∫≠n</label>
                            <input type="text" class="admin-input" id="transferUsername" placeholder="Nh·∫≠p username" required>
                        </div>
                        <div class="form-group">
                            <label>S·ªë ti·ªÅn chuy·ªÉn</label>
                            <input type="number" class="admin-input" id="transferAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn" min="1000" required>
                        </div>
                        <button type="submit" class="submit-btn">üí∞ Chuy·ªÉn ti·ªÅn ngay</button>
                    </form>
                </div>

                <!-- Ban User Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üö´</div>
                        <h3 class="panel-title">Ban User</h3>
                    </div>
                    <form class="admin-form" id="banForm">
                        <div class="form-group">
                            <label>T√™n t√†i kho·∫£n c·∫ßn ban</label>
                            <input type="text" class="admin-input" id="banUsername" placeholder="Nh·∫≠p username" required>
                        </div>
                        <div class="form-group">
                            <label>L√Ω do ban</label>
                            <textarea class="admin-input" id="banReason" placeholder="Nh·∫≠p l√Ω do..." rows="3"></textarea>
                        </div>
                        <button type="submit" class="submit-btn" style="background: var(--error-red);">üö´ Ban user n√†y</button>
                    </form>
                </div>

                <!-- Create Voucher Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üéüÔ∏è</div>
                        <h3 class="panel-title">T·∫°o M√£ Gi·∫£m Gi√°</h3>
                    </div>
                    <form class="admin-form" id="voucherForm">
                        <div class="form-group">
                            <label>M√£ gi·∫£m gi√°</label>
                            <input type="text" class="admin-input" id="voucherCode" placeholder="VD: SUMMER2024" required>
                        </div>
                        <div class="form-group">
                            <label>Ch·ªçn g√≥i tool √°p d·ª•ng</label>
                            <select class="admin-select" id="voucherTool" required>
                                <option value="all">T·∫•t c·∫£ c√°c tool</option>
                                <option value="toolv1">Tool V1</option>
                                <option value="toolmd5">Tool MD5</option>
                                <option value="toolsicbo">Tool Sicbo</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Gi·∫£m gi√° (%)</label>
                                <input type="number" class="admin-input" id="voucherDiscount" placeholder="VD: 20" min="1" max="100" required>
                            </div>
                            <div class="form-group">
                                <label>S·ªë l∆∞·ª£ng</label>
                                <input type="number" class="admin-input" id="voucherQuantity" placeholder="VD: 100" min="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ng√†y h·∫øt h·∫°n</label>
                            <input type="datetime-local" class="admin-input" id="voucherExpiry" required>
                        </div>
                        <button type="submit" class="submit-btn">üéüÔ∏è T·∫°o m√£ gi·∫£m gi√°</button>
                    </form>
                </div>

                <!-- Voucher List Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üìã</div>
                        <h3 class="panel-title">Danh S√°ch M√£ Gi·∫£m Gi√°</h3>
                    </div>
                    <div class="voucher-list" id="voucherList">
                        <!-- Vouchers will be loaded here -->
                        <div class="empty-state">
                            <div class="empty-icon">üéüÔ∏è</div>
                            <div class="empty-title">Ch∆∞a c√≥ m√£ gi·∫£m gi√°</div>
                        </div>
                    </div>
                </div>

                <!-- Admin Balance Panel -->
                <div class="admin-panel">
                    <div class="panel-header">
                        <div class="panel-icon">üí∞</div>
                        <h3 class="panel-title">Qu·∫£n L√Ω S·ªë D∆∞ Admin</h3>
                    </div>
                    <form class="admin-form" id="adminBalanceForm">
                        <div class="form-group">
                            <label>S·ªë d∆∞ hi·ªán t·∫°i</label>
                            <input type="text" class="admin-input" id="currentAdminBalance" value="100,000,000ƒë" disabled>
                        </div>
                        <div class="form-group">
                            <label>S·ªë ti·ªÅn mu·ªën c·ªông</label>
                            <input type="number" class="admin-input" id="addAdminBalance" placeholder="Nh·∫≠p s·ªë ti·ªÅn" min="1000">
                        </div>
                        <button type="submit" class="submit-btn">‚ûï C·ªông ti·ªÅn cho admin</button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="notification-icon">‚úì</div>
        <div class="notification-content">
            <div class="notification-title">Th√¥ng b√°o</div>
            <div class="notification-message">Message here</div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">X√°c nh·∫≠n h√†nh ƒë·ªông</h3>
                <button class="close-modal" onclick="closeModal('confirmModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn primary" id="confirmBtn">X√°c nh·∫≠n</button>
                <button class="modal-btn secondary" onclick="closeModal('confirmModal')">H·ªßy</button>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
    <script>
// Debug script for admin panel
console.log('=== ADMIN PANEL DEBUG ===');
console.log('Current users in localStorage:', JSON.parse(localStorage.getItem('users')));
console.log('Current user:', JSON.parse(localStorage.getItem('currentUser')));

// Test function to add sample users
function addTestUsers() {
    const users = JSON.parse(localStorage.getItem('users')) || [];
    
    const testUsers = [
        { username: 'user1', password: 'pass1', balance: 50000, isAdmin: false, createdAt: new Date().toISOString() },
        { username: 'user2', password: 'pass2', balance: 100000, isAdmin: false, createdAt: new Date().toISOString() },
        { username: 'user3', password: 'pass3', balance: 0, isAdmin: false, createdAt: new Date().toISOString() }
    ];
    
    testUsers.forEach(testUser => {
        if (!users.find(u => u.username === testUser.username)) {
            users.push(testUser);
        }
    });
    
    localStorage.setItem('users', JSON.stringify(users));
    console.log('Test users added:', testUsers);
    alert('ƒê√£ th√™m 3 user test: user1, user2, user3');
    window.location.reload();
}

// Test function to clear all users (except admin)
function clearTestUsers() {
    let users = JSON.parse(localStorage.getItem('users')) || [];
    users = users.filter(user => user.isAdmin); // Gi·ªØ l·∫°i admin
    localStorage.setItem('users', JSON.stringify(users));
    console.log('Cleared all non-admin users');
    alert('ƒê√£ x√≥a t·∫•t c·∫£ user th∆∞·ªùng');
    window.location.reload();
}
</script>
<script>
// DEBUG FUNCTIONS - X√ìA SAU KHI CH·∫†Y ·ªîN
console.log('=== DEBUG ADMIN PANEL ===');
console.log('Current user:', JSON.parse(localStorage.getItem('currentUser')));
console.log('All users:', JSON.parse(localStorage.getItem('users')));

// H√†m debug ƒë·ªÉ xem t·∫•t c·∫£ users
function debugUsers() {
    const users = JSON.parse(localStorage.getItem('users')) || [];
    console.log('=== DEBUG USERS ===');
    console.log('Total users:', users.length);
    users.forEach((user, index) => {
        console.log(`User ${index}:`, user);
    });
    alert(`T·ªïng s·ªë user: ${users.length}\nXem chi ti·∫øt trong console (F12)`);
}

// H√†m reset to√†n b·ªô d·ªØ li·ªáu
function resetAllData() {
    if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën RESET TO√ÄN B·ªò d·ªØ li·ªáu? ƒêi·ªÅu n√†y s·∫Ω x√≥a t·∫•t c·∫£ user v√† kh·ªüi t·∫°o l·∫°i t·ª´ ƒë·∫ßu.')) {
        localStorage.clear();
        
        // Kh·ªüi t·∫°o l·∫°i d·ªØ li·ªáu m·∫´u
        const users = [
            {
                username: 'bevis',
                password: 'leduc',
                balance: 100000000,
                isAdmin: true,
                createdAt: new Date().toISOString()
            }
        ];
        localStorage.setItem('users', JSON.stringify(users));
        
        const tools = {
            'toolv1': { active: false, expiry: null, key: null },
            'toolmd5': { active: false, expiry: null, key: null },
            'toolsicbo': { active: false, expiry: null, key: null }
        };
        localStorage.setItem('tools', JSON.stringify(tools));
        
        alert('ƒê√£ reset to√†n b·ªô d·ªØ li·ªáu!');
        window.location.reload();
    }
}

// H√†m th√™m user test
function addTestUser() {
    const users = JSON.parse(localStorage.getItem('users')) || [];
    const testUser = {
        username: 'testuser_' + Date.now(),
        password: '123456',
        balance: 50000,
        isAdmin: false,
        createdAt: new Date().toISOString()
    };
    
    users.push(testUser);
    localStorage.setItem('users', JSON.stringify(users));
    
    console.log('Added test user:', testUser);
    alert(`ƒê√£ th√™m user test: ${testUser.username}`);
    window.location.reload();
}

// Th√™m n√∫t debug v√†o giao di·ªán
document.addEventListener('DOMContentLoaded', function() {
    // T·∫°o container cho n√∫t debug
    const debugContainer = document.createElement('div');
    debugContainer.style.position = 'fixed';
    debugContainer.style.top = '10px';
    debugContainer.style.right = '10px';
    debugContainer.style.zIndex = '10000';
    debugContainer.style.display = 'flex';
    debugContainer.style.flexDirection = 'column';
    debugContainer.style.gap = '5px';
    
    // N√∫t debug users
    const debugBtn = document.createElement('button');
    debugBtn.textContent = 'üêõ Debug Users';
    debugBtn.style.padding = '8px 12px';
    debugBtn.style.background = '#ff6b6b';
    debugBtn.style.color = 'white';
    debugBtn.style.border = 'none';
    debugBtn.style.borderRadius = '5px';
    debugBtn.style.cursor = 'pointer';
    debugBtn.onclick = debugUsers;
    
    // N√∫t reset data
    const resetBtn = document.createElement('button');
    resetBtn.textContent = 'üîÑ Reset Data';
    resetBtn.style.padding = '8px 12px';
    resetBtn.style.background = '#f59e0b';
    resetBtn.style.color = 'white';
    resetBtn.style.border = 'none';
    resetBtn.style.borderRadius = '5px';
    resetBtn.style.cursor = 'pointer';
    resetBtn.onclick = resetAllData;
    
    // N√∫t th√™m user test
    const testBtn = document.createElement('button');
    testBtn.textContent = '‚ûï Test User';
    testBtn.style.padding = '8px 12px';
    testBtn.style.background = '#10b981';
    testBtn.style.color = 'white';
    testBtn.style.border = 'none';
    testBtn.style.borderRadius = '5px';
    testBtn.style.cursor = 'pointer';
    testBtn.onclick = addTestUser;
    
    debugContainer.appendChild(debugBtn);
    debugContainer.appendChild(resetBtn);
    debugContainer.appendChild(testBtn);
    document.body.appendChild(debugContainer);
});
</script>
</body>
</html>
