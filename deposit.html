// deposit.js - Xá»­ lÃ½ náº¡p tiá»n
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ’° Deposit page loaded');
    
    // Kiá»ƒm tra Ä‘Äƒng nháº­p
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (!currentUser) {
        window.location.href = 'index.html';
        return;
    }
    
    // Cáº­p nháº­t thÃ´ng tin header
    updateHeaderInfo(currentUser);
    
    // Khá»Ÿi táº¡o sidebar
    initSidebar();
    
    // Táº¡o ná»™i dung chuyá»ƒn khoáº£n tá»± Ä‘á»™ng
    const transferContent = document.getElementById('transferContent');
    if (transferContent) {
        transferContent.textContent = `${currentUser.username} naptien LDP`;
    }
    
    console.log('âœ… Deposit page initialized');
});

// Cáº­p nháº­t thÃ´ng tin header
function updateHeaderInfo(user) {
    const usernameEl = document.getElementById('headerUsername');
    const balanceEl = document.getElementById('headerBalance');
    
    if (usernameEl) usernameEl.textContent = user.username;
    if (balanceEl) balanceEl.textContent = formatCurrency(user.balance);
}

// Äá»‹nh dáº¡ng tiá»n tá»‡
function formatCurrency(amount) {
    return new Intl.NumberFormat('vi-VN', {
        style: 'currency',
        currency: 'VND'
    }).format(amount);
}

// Khá»Ÿi táº¡o sidebar
function initSidebar() {
    const menuIcon = document.getElementById('menuIcon');
    const sidebar = document.getElementById('sidebar');
    
    if (menuIcon && sidebar) {
        menuIcon.addEventListener('click', function() {
            sidebar.classList.toggle('active');
        });
    }
}

// Sao chÃ©p text
function copyText(elementId) {
    const element = document.getElementById(elementId);
    const text = element.textContent;
    navigator.clipboard.writeText(text).then(() => {
        showNotification('ÄÃ£ sao chÃ©p!');
    });
}

// Ãp dá»¥ng voucher
function applyVoucher() {
    showNotification('MÃ£ giáº£m giÃ¡ khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ háº¿t háº¡n!', 'error');
}

// Hiá»ƒn thá»‹ thÃ´ng bÃ¡o
function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    if (!notification) {
        alert(message);
        return;
    }
    
    const messageEl = notification.querySelector('.notification-message');
    if (!messageEl) return;
    
    messageEl.textContent = message;
    notification.className = `notification ${type}`;
    notification.classList.add('show');
    
    setTimeout(() => {
        notification.classList.remove('show');
    }, 3000);
}

// ÄÄƒng xuáº¥t
function logout() {
    localStorage.removeItem('currentUser');
    window.location.href = 'index.html';
}

// Hiá»ƒn thá»‹ lá»‹ch sá»­
function showHistory() {
    showNotification('TÃ­nh nÄƒng Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn...');
}
